<html>
<head>
<title>elements_page.py</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.s0 { color: #cc7832;}
.s1 { color: #a9b7c6;}
.s2 { color: #6a8759;}
.s3 { color: #6897bb;}
.s4 { color: #808080;}
.s5 { color: #a5c261;}
</style>
</head>
<body bgcolor="#2b2b2b">
<table CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#606060" >
<tr><td><center>
<font face="Arial, Helvetica" color="#000000">
elements_page.py</font>
</center></td></tr></table>
<pre><span class="s0">import </span><span class="s1">base64</span>
<span class="s0">import </span><span class="s1">time</span>
<span class="s0">import </span><span class="s1">os</span>
<span class="s0">import </span><span class="s1">random</span>
<span class="s0">from </span><span class="s1">generator.generator </span><span class="s0">import </span><span class="s1">generated_person</span><span class="s0">, </span><span class="s1">generated_file</span>
<span class="s0">from </span><span class="s1">locators.elements_page_locators </span><span class="s0">import </span><span class="s1">TextBoxPageLocators</span><span class="s0">, </span><span class="s1">CheckBoxPageLocators</span><span class="s0">, </span><span class="s1">RadioButtonPageLocators</span><span class="s0">, </span><span class="s1">WebTablePageLocators</span><span class="s0">, </span><span class="s1">ButtonsPageLocators</span><span class="s0">, </span><span class="s1">LinksPageLocators</span><span class="s0">, </span><span class="s1">UploadAndDownloadPageLocators</span><span class="s0">, </span><span class="s1">DynamicPropertiesPageLocators</span>
<span class="s0">from </span><span class="s1">pages.base_page </span><span class="s0">import </span><span class="s1">BasePage</span>
<span class="s0">import </span><span class="s1">requests</span>
<span class="s0">from </span><span class="s1">selenium.common.exceptions </span><span class="s0">import </span><span class="s1">TimeoutException</span>
<span class="s0">from </span><span class="s1">selenium.webdriver.common.by </span><span class="s0">import </span><span class="s1">By</span>



<span class="s0">class </span><span class="s1">TextBoxPage(BasePage):</span>
    <span class="s1">locators = TextBoxPageLocators()</span>

    <span class="s0">def </span><span class="s1">fill_all_fields(self):</span>
        <span class="s1">person_info = next(generated_person())</span>
        <span class="s1">full_name = person_info.full_name</span>
        <span class="s1">email = person_info.email</span>
        <span class="s1">current_address = person_info.current_address</span>
        <span class="s1">permanent_address = person_info.permanent_address</span>
        <span class="s1">self.element_is_visible(self.locators.FULL_NAME).send_keys(full_name)</span>
        <span class="s1">self.element_is_visible(self.locators.EMAIL).send_keys(email)</span>
        <span class="s1">self.element_is_visible(self.locators.CURRENT_ADDRESS).send_keys(current_address)</span>
        <span class="s1">self.element_is_visible(self.locators.PERMANENT_ADDRESS).send_keys(permanent_address)</span>
        <span class="s1">self.element_is_visible(self.locators.SUBMIT).click()</span>
        <span class="s0">return </span><span class="s1">full_name</span><span class="s0">, </span><span class="s1">email</span><span class="s0">, </span><span class="s1">current_address</span><span class="s0">, </span><span class="s1">permanent_address</span>

    <span class="s0">def </span><span class="s1">check_filled_form(self):</span>
        <span class="s1">full_name = self.element_is_present(self.locators.CREATED_FULL_NAME).text.split(</span><span class="s2">':'</span><span class="s1">)[</span><span class="s3">1</span><span class="s1">]</span>
        <span class="s1">email = self.element_is_present(self.locators.CREATED_EMAIL).text.split(</span><span class="s2">':'</span><span class="s1">)[</span><span class="s3">1</span><span class="s1">]</span>
        <span class="s1">current_address = self.element_is_present(self.locators.CREATED_CURRENT_ADDRESS).text.split(</span><span class="s2">':'</span><span class="s1">)[</span><span class="s3">1</span><span class="s1">]</span>
        <span class="s1">permanent_address = self.element_is_present(self.locators.CREATED_PERMANENT_ADDRESS).text.split(</span><span class="s2">':'</span><span class="s1">)[</span><span class="s3">1</span><span class="s1">]</span>
        <span class="s0">return </span><span class="s1">full_name</span><span class="s0">, </span><span class="s1">email</span><span class="s0">, </span><span class="s1">current_address</span><span class="s0">, </span><span class="s1">permanent_address</span>

<span class="s0">class </span><span class="s1">CheckBoxPage(BasePage):</span>

    <span class="s1">locators = CheckBoxPageLocators()</span>

    <span class="s0">def </span><span class="s1">open_full_list(self):</span>
        <span class="s1">self.element_is_visible(self.locators.EXPAND_ALL_BUTTON).click()</span>

    <span class="s0">def </span><span class="s1">click_random_checkbox(self):</span>
        <span class="s1">item_list = self.elements_are_visible(self.locators.ITEM_LIST)</span>
        <span class="s1">count = </span><span class="s3">21</span>
        <span class="s0">while </span><span class="s1">count != </span><span class="s3">0</span><span class="s1">:</span>
            <span class="s1">item = item_list[random.randint(</span><span class="s3">1</span><span class="s0">, </span><span class="s3">15</span><span class="s1">)]</span>
            <span class="s0">if </span><span class="s1">count &gt; </span><span class="s3">0</span><span class="s1">:</span>
                <span class="s1">self.go_to_element(item)</span>
                <span class="s1">item.click()</span>
                <span class="s4"># print(item.text)</span>
                <span class="s1">count -= </span><span class="s3">1</span>
            <span class="s0">else</span><span class="s1">:</span>
                <span class="s0">break</span>

    <span class="s0">def </span><span class="s1">get_checked_checkboxes(self):</span>
        <span class="s1">checked_list = self.elements_are_present(self.locators.CHECKED_ITEMS)</span>
        <span class="s1">data = []</span>
        <span class="s0">for </span><span class="s1">box </span><span class="s0">in </span><span class="s1">checked_list:</span>
            <span class="s1">title_item = box.find_element_by_xpath(self.locators.TITLE_ITEM)</span>
            <span class="s4"># title_item = box.find_elements_by_css_selector(self.locators.TITLE_ITEM)</span>
            <span class="s4"># print(title_item.text)</span>
            <span class="s1">data.append(title_item.text)</span>
        <span class="s4"># print(data)</span>
        <span class="s0">return </span><span class="s1">str(data).replace(</span><span class="s2">' '</span><span class="s0">, </span><span class="s2">''</span><span class="s1">).replace(</span><span class="s2">'doc'</span><span class="s0">, </span><span class="s2">''</span><span class="s1">).replace(</span><span class="s2">'.'</span><span class="s0">, </span><span class="s2">''</span><span class="s1">).lower()</span>

    <span class="s0">def </span><span class="s1">get_output_result(self):</span>
        <span class="s1">result_list = self.elements_are_present(self.locators.OUTPUT_RESULT)</span>
        <span class="s1">data = []</span>
        <span class="s0">for </span><span class="s1">item </span><span class="s0">in </span><span class="s1">result_list:</span>
            <span class="s1">data.append(item.text)</span>
        <span class="s0">return </span><span class="s1">str(data).replace(</span><span class="s2">' '</span><span class="s0">, </span><span class="s2">''</span><span class="s1">).lower()</span>
        <span class="s4"># print(data)</span>

<span class="s0">class </span><span class="s1">RadioButtonPage(BasePage):</span>
    <span class="s1">locators = RadioButtonPageLocators()</span>

    <span class="s0">def </span><span class="s1">click_on_the_radio_button(self</span><span class="s0">, </span><span class="s1">choice):</span>
        <span class="s1">choices = {</span><span class="s2">'yes'</span><span class="s1">: self.locators.YES_RADIOBUTTON</span><span class="s0">,</span>
                   <span class="s2">'impressive'</span><span class="s1">: self.locators.IMPRESSIVE_RADIOBUTTON</span><span class="s0">,</span>
                   <span class="s2">'no'</span><span class="s1">: self.locators.NO_RADIOBUTTON}</span>
        <span class="s1">self.element_is_visible(choices[choice]).click()</span>

    <span class="s0">def </span><span class="s1">get_output_result(self):</span>
        <span class="s0">return </span><span class="s1">self.element_is_present(self.locators.OUTPUT_RESULT).text</span>


<span class="s0">class </span><span class="s1">WebTablePage(BasePage):</span>
    <span class="s1">locators = WebTablePageLocators()</span>

    <span class="s0">def </span><span class="s1">add_new_person(self):</span>
        <span class="s4"># count = random.randint(1,3)</span>
        <span class="s1">count = </span><span class="s3">1</span>
        <span class="s0">while </span><span class="s1">count != </span><span class="s3">0</span><span class="s1">:</span>
            <span class="s1">person_info = next(generated_person())</span>
            <span class="s1">firstname = person_info.firstname</span>
            <span class="s1">lastname = person_info.lastname</span>
            <span class="s1">email = person_info.email</span>
            <span class="s1">age = person_info.age</span>
            <span class="s1">salary = person_info.salary</span>
            <span class="s1">department = person_info.department</span>
            <span class="s1">self.element_is_visible(self.locators.ADD_BUTTON).click()</span>
            <span class="s1">self.element_is_visible(self.locators.FIRSTNAME_INPUT).send_keys(firstname)</span>
            <span class="s1">self.element_is_visible(self.locators.LASTNAME_INPUT).send_keys(lastname)</span>
            <span class="s1">self.element_is_visible(self.locators.EMAIL_INPUT).send_keys(email)</span>
            <span class="s1">self.element_is_visible(self.locators.AGE_INPUT).send_keys(age)</span>
            <span class="s1">self.element_is_visible(self.locators.SALARY_INPUT).send_keys(salary)</span>
            <span class="s1">self.element_is_visible(self.locators.DEPARTMENT_INPUT).send_keys(department)</span>
            <span class="s1">self.element_is_visible(self.locators.SUBMIT).click()</span>
            <span class="s1">count -= </span><span class="s3">1</span>
        <span class="s0">return </span><span class="s1">[firstname</span><span class="s0">, </span><span class="s1">lastname</span><span class="s0">, </span><span class="s1">str(age)</span><span class="s0">, </span><span class="s1">email</span><span class="s0">, </span><span class="s1">str(salary)</span><span class="s0">, </span><span class="s1">department]</span>
            <span class="s4"># return firstname, lastname, age, email, salary, department</span>

    <span class="s0">def </span><span class="s1">check_new_added_person(self):</span>
        <span class="s1">people_list = self.elements_are_visible(self.locators.FULL_PEOPLE_LIST)</span>
        <span class="s4"># people_list1 = splitlines(people_list) &quot;&quot;&quot;!!!&quot;&quot;&quot;</span>
        <span class="s4"># return people_list1 &quot;&quot;&quot;!!!&quot;&quot;&quot;</span>
        <span class="s4"># people_list = self.elements_are_present(self.locators.FULL_PEOPLE_LIST).text</span>
        <span class="s4"># print(people_list)</span>
        <span class="s4"># data = [people_list]</span>
        <span class="s1">data = []</span>
        <span class="s0">for </span><span class="s1">item </span><span class="s0">in </span><span class="s1">people_list:</span>
            <span class="s1">data.append(item.text.splitlines())</span>
            <span class="s4"># print(item.text)</span>
        <span class="s4"># print(data)</span>
        <span class="s0">return </span><span class="s1">data</span>
        <span class="s4"># return str(people_list).replace(' ', '').lower()</span>
        <span class="s4"># return [people_list]</span>
        <span class="s4"># return people_list</span>

    <span class="s0">def </span><span class="s1">search_some_person(self</span><span class="s0">, </span><span class="s1">key_word):</span>
        <span class="s1">self.element_is_visible(self.locators.SEARCH_INPUT).send_keys(key_word)</span>

    <span class="s0">def </span><span class="s1">check_search_person(self):</span>
        <span class="s1">delete_button = self.element_is_present(self.locators.DELETE_BUTTON)</span>
        <span class="s4"># row = delete_button.find_element_by_xpath(self.locators.ROW_PARENT)</span>
        <span class="s1">row = delete_button.find_element(</span><span class="s2">&quot;xpath&quot;</span><span class="s0">, </span><span class="s1">self.locators.ROW_PARENT)</span>
        <span class="s0">return </span><span class="s1">row.text.splitlines()</span>

    <span class="s0">def </span><span class="s1">update_person_info(self):</span>
        <span class="s1">person_info = next(generated_person())</span>
        <span class="s1">age = person_info.age</span>
        <span class="s1">self.element_is_visible(self.locators.UPDATE_BUTTON).click()</span>
        <span class="s1">self.element_is_visible(self.locators.AGE_INPUT).clear()</span>
        <span class="s1">self.element_is_visible(self.locators.AGE_INPUT).send_keys(age)</span>
        <span class="s1">self.element_is_visible(self.locators.SUBMIT).click()</span>
        <span class="s0">return </span><span class="s1">str(age)</span>

    <span class="s0">def </span><span class="s1">delete_person(self):</span>
        <span class="s1">self.element_is_visible(self.locators.DELETE_BUTTON).click()</span>

    <span class="s0">def </span><span class="s1">check_deleted(self):</span>
        <span class="s0">return </span><span class="s1">self.element_is_visible(self.locators.NO_ROWS_FOUND).text</span>

    <span class="s0">def </span><span class="s1">select_up_to_some_rows(self):</span>
        <span class="s1">count = [</span><span class="s3">5</span><span class="s0">, </span><span class="s3">10</span><span class="s0">, </span><span class="s3">20</span><span class="s0">, </span><span class="s3">25</span><span class="s0">, </span><span class="s3">50</span><span class="s0">, </span><span class="s3">100</span><span class="s1">]</span>
        <span class="s1">data = []</span>
        <span class="s0">for </span><span class="s1">x </span><span class="s0">in </span><span class="s1">count:</span>
            <span class="s1">count_row_button = self.element_is_present(self.locators.COUNT_ROW_LIST)</span>
            <span class="s1">self.go_to_element(count_row_button)</span>
            <span class="s1">count_row_button.click()</span>
            <span class="s1">self.element_is_visible((By.CSS_SELECTOR</span><span class="s0">, </span><span class="s2">f'option[value=&quot;</span><span class="s0">{</span><span class="s1">x</span><span class="s0">}</span><span class="s2">&quot;]'</span><span class="s1">)).click()</span>
            <span class="s1">data.append(self.check_count_rows())</span>
        <span class="s0">return </span><span class="s1">data</span>

    <span class="s0">def </span><span class="s1">check_count_rows(self):</span>
        <span class="s1">list_rows = self.elements_are_visible(self.locators.FULL_PEOPLE_LIST)</span>
        <span class="s0">return </span><span class="s1">len(list_rows)</span>

<span class="s0">class </span><span class="s1">ButtonsPage(BasePage):</span>
    <span class="s1">locators = ButtonsPageLocators()</span>

    <span class="s0">def </span><span class="s1">click_on_different_button(self</span><span class="s0">, </span><span class="s1">type_click):</span>
        <span class="s0">if </span><span class="s1">type_click == </span><span class="s2">&quot;double&quot;</span><span class="s1">:</span>
            <span class="s1">self.action_double_click(self.element_is_visible(self.locators.DOUBLE_BUTTON))</span>
            <span class="s0">return </span><span class="s1">self.check_clicked_on_the_button(self.locators.SUCCESS_DOUBLE)</span>
        <span class="s0">if </span><span class="s1">type_click == </span><span class="s2">&quot;right&quot;</span><span class="s1">:</span>
            <span class="s1">self.action_right_click(self.element_is_visible(self.locators.RIGHT_CLICK_BUTTON))</span>
            <span class="s0">return </span><span class="s1">self.check_clicked_on_the_button(self.locators.SUCCESS_RIGHT)</span>
        <span class="s0">if </span><span class="s1">type_click == </span><span class="s2">&quot;click&quot;</span><span class="s1">:</span>
            <span class="s1">self.element_is_visible(self.locators.CLICK_ME_BUTTON).click()</span>
            <span class="s0">return </span><span class="s1">self.check_clicked_on_the_button(self.locators.SUCCESS_CLICK_ME)</span>


    <span class="s0">def </span><span class="s1">check_clicked_on_the_button(self</span><span class="s0">, </span><span class="s1">element):</span>
        <span class="s0">return </span><span class="s1">self.element_is_present(element).text</span>


<span class="s0">class </span><span class="s1">LinksPage(BasePage):</span>

    <span class="s1">locators = LinksPageLocators()</span>

    <span class="s0">def </span><span class="s1">check_new_tab_simple_link(self):</span>
        <span class="s1">simple_link = self.element_is_visible(self.locators.SIMPLE_LINK)</span>
        <span class="s1">link_href = simple_link.get_attribute(</span><span class="s2">'href'</span><span class="s1">)</span>
        <span class="s1">request = requests.get(link_href)</span>
        <span class="s0">if </span><span class="s1">request.status_code == </span><span class="s3">200</span><span class="s1">:</span>
            <span class="s1">simple_link.click()</span>
            <span class="s1">self.driver.switch_to.window(self.driver.window_handles[</span><span class="s3">1</span><span class="s1">])</span>
            <span class="s1">url = self.driver.current_url</span>
            <span class="s0">return </span><span class="s1">link_href</span><span class="s0">, </span><span class="s1">url</span>
        <span class="s0">else</span><span class="s1">:</span>
            <span class="s0">return </span><span class="s1">link_href</span><span class="s0">, </span><span class="s1">request.status_code</span>

        <span class="s0">def </span><span class="s1">check_broken_link(self</span><span class="s0">, </span><span class="s1">url):</span>
            <span class="s1">request = requests.get(url)</span>
            <span class="s0">if </span><span class="s1">request.status_code == </span><span class="s3">200</span><span class="s1">:</span>
                <span class="s1">self.element_is_present(self.locators.BAD_REQUEST).click()</span>
            <span class="s0">else</span><span class="s1">:</span>
                <span class="s0">return </span><span class="s1">request.status_code</span>

<span class="s0">class </span><span class="s1">UploadAndDownloadPage(BasePage):</span>
    <span class="s1">locators = UploadAndDownloadPageLocators()</span>

    <span class="s0">def </span><span class="s1">upload_file(self):</span>
        <span class="s1">file_name</span><span class="s0">, </span><span class="s1">path = generated_file()</span>
        <span class="s1">self.element_is_present(self.locators.UPLOAD_FILE).send_keys(path)</span>
        <span class="s1">os.remove(path)</span>
        <span class="s1">text = self.element_is_present(self.locators.UPLOADED_RESULT).text</span>
        <span class="s0">return </span><span class="s1">file_name.split(</span><span class="s2">'</span><span class="s0">\\</span><span class="s2">'</span><span class="s1">)[-</span><span class="s3">1</span><span class="s1">]</span><span class="s0">, </span><span class="s1">text.split(</span><span class="s2">'</span><span class="s0">\\</span><span class="s2">'</span><span class="s1">)[-</span><span class="s3">1</span><span class="s1">]</span>

    <span class="s0">def </span><span class="s1">download_file(self):</span>
        <span class="s1">link = self.element_is_present(self.locators.DOWNLOAD_FILE).get_attribute(</span><span class="s2">'href'</span><span class="s1">)</span>
        <span class="s1">link_b = base64.b64decode(link)</span>
        <span class="s1">path_name_file = </span><span class="s2">rf'C:\Automation\filetest</span><span class="s0">{</span><span class="s1">random.randint(</span><span class="s3">0</span><span class="s0">, </span><span class="s3">999</span><span class="s1">)</span><span class="s0">}</span><span class="s2">.jpg'</span>
        <span class="s0">with </span><span class="s1">open(path_name_file</span><span class="s0">, </span><span class="s2">'wb+'</span><span class="s1">) </span><span class="s0">as </span><span class="s1">f:</span>
            <span class="s1">offset = link_b.find(</span><span class="s5">b'</span><span class="s0">\xff\xd8</span><span class="s5">'</span><span class="s1">)</span>
            <span class="s1">f.write(link_b[offset:])</span>
            <span class="s1">check_file = os.path.exists(path_name_file)</span>
            <span class="s1">f.close()</span>
        <span class="s1">os.remove(path_name_file)</span>
        <span class="s0">return </span><span class="s1">check_file</span>

<span class="s0">class </span><span class="s1">DynamicPropertiesPage(BasePage):</span>

    <span class="s1">locators = DynamicPropertiesPageLocators()</span>

    <span class="s0">def </span><span class="s1">check_enable_button(self):</span>
        <span class="s0">try</span><span class="s1">:</span>
            <span class="s1">self.element_is_clicable(self.locators.ENABLE_BUTTON)</span>
        <span class="s0">except </span><span class="s1">TimeoutException:</span>
            <span class="s0">return False</span>
        <span class="s0">return True</span>


    <span class="s0">def </span><span class="s1">check_chanced_of_color(self):</span>
        <span class="s1">color_button = self.element_is_present(self.locators.COLOR_CHANGE_BUTTON)</span>
        <span class="s1">color_button_before = color_button.value_of_css_property(</span><span class="s2">'color'</span><span class="s1">)</span>
        <span class="s4"># time.sleep(5)</span>
        <span class="s1">color_button_after = color_button.value_of_css_property(</span><span class="s2">'color'</span><span class="s1">)</span>
        <span class="s4"># print(color_button_before, color_button_after)</span>
        <span class="s0">return </span><span class="s1">color_button_before</span><span class="s0">, </span><span class="s1">color_button_after</span>

    <span class="s0">def </span><span class="s1">check_appear_of_button(self):</span>
        <span class="s0">try</span><span class="s1">:</span>
            <span class="s1">self.element_is_visible(self.locators.VISIBLE_AFTER_FIVE_SEC_BUTTON)</span>
        <span class="s0">except </span><span class="s1">TimeoutException:</span>
            <span class="s0">return False</span>
        <span class="s0">return True</span>








</pre>
</body>
</html>