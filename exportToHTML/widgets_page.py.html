<html>
<head>
<title>widgets_page.py</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.s0 { color: #cc7832;}
.s1 { color: #a9b7c6;}
.s2 { color: #6a8759;}
.s3 { color: #6897bb;}
</style>
</head>
<body bgcolor="#2b2b2b">
<table CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#606060" >
<tr><td><center>
<font face="Arial, Helvetica" color="#000000">
widgets_page.py</font>
</center></td></tr></table>
<pre><span class="s0">import </span><span class="s1">random</span>
<span class="s0">import </span><span class="s1">time</span>
<span class="s0">from </span><span class="s1">selenium.common.exceptions </span><span class="s0">import </span><span class="s1">TimeoutException</span>
<span class="s0">from </span><span class="s1">selenium.webdriver </span><span class="s0">import </span><span class="s1">Keys</span>
<span class="s0">from </span><span class="s1">selenium.webdriver.support.select </span><span class="s0">import </span><span class="s1">Select</span>
<span class="s0">from </span><span class="s1">generator.generator </span><span class="s0">import </span><span class="s1">generated_color</span><span class="s0">, </span><span class="s1">generated_date</span>
<span class="s0">from </span><span class="s1">locators.widgets_page_locators </span><span class="s0">import </span><span class="s1">AccordianPageLocators</span><span class="s0">, </span><span class="s1">AutoCompletePageLocators</span><span class="s0">, </span><span class="s1">DatePickerPageLocators</span><span class="s0">, </span><span class="s1">SliderPageLocators</span><span class="s0">, </span><span class="s1">ProgressBarPageLocators</span><span class="s0">, </span><span class="s1">TabsPageLocators</span><span class="s0">, </span><span class="s1">ToolTipsPageLocators</span><span class="s0">, </span><span class="s1">MenuPageLocators</span>
<span class="s0">from </span><span class="s1">pages.base_page </span><span class="s0">import </span><span class="s1">BasePage</span>

<span class="s0">class </span><span class="s1">AccordianPage(BasePage):</span>
    <span class="s1">locators = AccordianPageLocators()</span>

    <span class="s0">def </span><span class="s1">check_accordian(self</span><span class="s0">, </span><span class="s1">accordian_num):</span>
        <span class="s1">accordian = {</span><span class="s2">'first'</span><span class="s1">:</span>
                         <span class="s1">{</span><span class="s2">'title'</span><span class="s1">: self.locators.SECTION_FIRST</span><span class="s0">,</span>
                          <span class="s2">'content'</span><span class="s1">: self.locators.SECTION_CONTENT_FIRST}</span><span class="s0">,</span>
                     <span class="s2">'second'</span><span class="s1">:</span>
                         <span class="s1">{</span><span class="s2">'title'</span><span class="s1">: self.locators.SECTION_SECOND</span><span class="s0">,</span>
                          <span class="s2">'content'</span><span class="s1">: self.locators.SECTION_CONTENT_SECOND}</span><span class="s0">,</span>
                     <span class="s2">'third'</span><span class="s1">:</span>
                         <span class="s1">{</span><span class="s2">'title'</span><span class="s1">: self.locators.SECTION_THIRD</span><span class="s0">,</span>
                          <span class="s2">'content'</span><span class="s1">: self.locators.SECTION_CONTENT_THIRD}</span><span class="s0">,</span>
                     <span class="s1">}</span>

        <span class="s1">section_title = self.element_is_visible(accordian[accordian_num][</span><span class="s2">'title'</span><span class="s1">])</span>
        <span class="s1">section_title.click()</span>
        <span class="s0">try</span><span class="s1">:</span>
            <span class="s1">section_content = self.element_is_visible(accordian[accordian_num][</span><span class="s2">'content'</span><span class="s1">]).text</span>
        <span class="s0">except </span><span class="s1">TimeoutException:</span>
            <span class="s1">section_title.click()</span>
            <span class="s1">section_content = self.element_is_visible(accordian[accordian_num][</span><span class="s2">'content'</span><span class="s1">]).text</span>
        <span class="s0">return </span><span class="s1">[section_title.text</span><span class="s0">, </span><span class="s1">len(section_content)]</span>

<span class="s0">class </span><span class="s1">AutoCompletePage(BasePage):</span>
    <span class="s1">locators = AutoCompletePageLocators()</span>

    <span class="s0">def </span><span class="s1">fill_input_multi(self):</span>
        <span class="s1">colors = random.sample(next(generated_color()).color_name</span><span class="s0">, </span><span class="s1">k=random.randint(</span><span class="s3">2</span><span class="s0">, </span><span class="s3">5</span><span class="s1">))</span>
        <span class="s0">for </span><span class="s1">color </span><span class="s0">in </span><span class="s1">colors:</span>
            <span class="s1">input_multi = self.element_is_clicable(self.locators.MULTI_INPUT)</span>
            <span class="s1">input_multi.send_keys(color)</span>
            <span class="s1">input_multi.send_keys(Keys.ENTER)</span>
        <span class="s0">return </span><span class="s1">colors</span>

    <span class="s0">def </span><span class="s1">remove_value_from_multi(self):</span>
        <span class="s1">count_value_before = len(self.elements_are_visible(self.locators.MULTI_VALUE))</span>
        <span class="s1">remove_button_list = self.elements_are_visible(self.locators.MULTI_VALUE_REMOVE)</span>
        <span class="s0">for </span><span class="s1">value </span><span class="s0">in </span><span class="s1">remove_button_list:</span>
            <span class="s1">value.click()</span>
            <span class="s0">break</span>
        <span class="s1">count_value_after = len(self.elements_are_visible(self.locators.MULTI_VALUE))</span>
        <span class="s0">return </span><span class="s1">count_value_before</span><span class="s0">, </span><span class="s1">count_value_after</span>

    <span class="s0">def </span><span class="s1">check_color_in_multi(self):</span>
        <span class="s1">color_list = self.elements_are_visible(self.locators.MULTI_VALUE)</span>
        <span class="s1">colors = []</span>
        <span class="s0">for </span><span class="s1">color </span><span class="s0">in </span><span class="s1">color_list:</span>
            <span class="s1">colors.append(color.text)</span>
        <span class="s0">return </span><span class="s1">colors</span>

    <span class="s0">def </span><span class="s1">fill_input_single(self):</span>
        <span class="s1">color = random.sample(next(generated_color()).color_name</span><span class="s0">, </span><span class="s1">k=</span><span class="s3">1</span><span class="s1">)</span>
        <span class="s1">input_single = self.element_is_visible(self.locators.SINGLE_INPUT)</span>
        <span class="s1">input_single.send_keys(color)</span>
        <span class="s1">input_single.send_keys(Keys.ENTER)</span>
        <span class="s0">return </span><span class="s1">color[</span><span class="s3">0</span><span class="s1">]</span>

    <span class="s0">def </span><span class="s1">check_color_in_single(self):</span>
        <span class="s1">color = self.element_is_visible(self.locators.SINGLE_VALUE)</span>
        <span class="s0">return </span><span class="s1">color.text</span>

<span class="s0">class </span><span class="s1">DatePickerPage(BasePage):</span>
    <span class="s1">locators = DatePickerPageLocators()</span>

    <span class="s0">def </span><span class="s1">select_date(self):</span>
        <span class="s1">date = next(generated_date())</span>
        <span class="s1">input_date = self.element_is_visible(self.locators.DATE_INPUT)</span>
        <span class="s1">value_date_before = input_date.get_attribute(</span><span class="s2">'value'</span><span class="s1">)</span>
        <span class="s1">input_date.click()</span>
        <span class="s1">self.set_date_by_text(self.locators.DATE_SELECT_MONTH</span><span class="s0">, </span><span class="s1">date.month)</span>
        <span class="s1">self.set_date_by_text(self.locators.DATE_SELECT_YEAR</span><span class="s0">, </span><span class="s1">date.year)</span>
        <span class="s1">self.set_date_item_from_list(self.locators.DATE_SELECT_DAY_LIST</span><span class="s0">, </span><span class="s1">date.day)</span>
        <span class="s1">value_date_after = input_date.get_attribute(</span><span class="s2">'value'</span><span class="s1">)</span>
        <span class="s0">return </span><span class="s1">value_date_before</span><span class="s0">, </span><span class="s1">value_date_after</span>

    <span class="s0">def </span><span class="s1">select_date_and_time(self):</span>
        <span class="s1">date = next(generated_date())</span>
        <span class="s1">input_date = self.element_is_visible(self.locators.DATE_AND_TIME_INPUT)</span>
        <span class="s1">value_date_before = input_date.get_attribute(</span><span class="s2">'value'</span><span class="s1">)</span>
        <span class="s1">input_date.click()</span>
        <span class="s1">self.element_is_clickable(self.locators.DATE_AND_TIME_MONTH).click()</span>
        <span class="s1">self.set_date_item_from_list(self.locators.DATE_AND_TIME_MONTH_LIST</span><span class="s0">, </span><span class="s1">date.month)</span>
        <span class="s1">self.element_is_clickable(self.locators.DATE_AND_TIME_YEAR).click()</span>
        <span class="s1">self.set_date_item_from_list(self.locators.DATE_AND_TIME_YEAR_LIST</span><span class="s0">, </span><span class="s2">'2020'</span><span class="s1">)</span>
        <span class="s1">self.set_date_item_from_list(self.locators.DATE_SELECT_DAY_LIST</span><span class="s0">, </span><span class="s1">date.day)</span>
        <span class="s1">self.set_date_item_from_list(self.locators.DATE_AND_TIME_TIME_LIST</span><span class="s0">, </span><span class="s1">date.time)</span>
        <span class="s1">input_date_after = self.element_is_visible(self.locators.DATE_AND_TIME_INPUT)</span>
        <span class="s1">value_date_after = input_date_after.get_attribute(</span><span class="s2">'value'</span><span class="s1">)</span>
        <span class="s0">return </span><span class="s1">value_date_before</span><span class="s0">, </span><span class="s1">value_date_after</span>

    <span class="s0">def </span><span class="s1">set_date_by_text(self</span><span class="s0">, </span><span class="s1">element</span><span class="s0">, </span><span class="s1">value):</span>
        <span class="s1">select = Select(self.element_is_present(element))</span>
        <span class="s1">select.select_by_visible_text(value)</span>

    <span class="s0">def </span><span class="s1">set_date_item_from_list(self</span><span class="s0">, </span><span class="s1">elements</span><span class="s0">, </span><span class="s1">value):</span>
        <span class="s1">item_list = self.elements_are_visible(elements)</span>
        <span class="s0">for </span><span class="s1">item </span><span class="s0">in </span><span class="s1">item_list:</span>
            <span class="s0">if </span><span class="s1">item.text == value:</span>
                <span class="s1">item.click()</span>
                <span class="s0">break</span>

<span class="s0">class </span><span class="s1">SliderPage(BasePage):</span>
    <span class="s1">locators = SliderPageLocators()</span>

    <span class="s0">def </span><span class="s1">change_slider_value(self):</span>
        <span class="s1">value_before = self.element_is_visible(self.locators.SLIDER_VALUE).get_attribute(</span><span class="s2">'value'</span><span class="s1">)</span>
        <span class="s1">slider_input = self.element_is_visible(self.locators.INPUT_SLIDER)</span>
        <span class="s1">self.action_drag_and_drop_by_offset(slider_input</span><span class="s0">, </span><span class="s1">random.randint(</span><span class="s3">1</span><span class="s0">, </span><span class="s3">100</span><span class="s1">)</span><span class="s0">, </span><span class="s3">0</span><span class="s1">)</span>
        <span class="s1">value_after = self.element_is_visible(self.locators.SLIDER_VALUE).get_attribute(</span><span class="s2">'value'</span><span class="s1">)</span>
        <span class="s0">return </span><span class="s1">value_before</span><span class="s0">, </span><span class="s1">value_after</span>

<span class="s0">class </span><span class="s1">ProgressBarPage(BasePage):</span>
    <span class="s1">locators = ProgressBarPageLocators()</span>

    <span class="s0">def </span><span class="s1">change_progress_bar_value(self):</span>
        <span class="s1">value_before = self.element_is_present(self.locators.PROGRESS_BAR_VALUE).text</span>
        <span class="s1">progress_bar_button = self.element_is_visible(self.locators.PROGRESS_BAR_BUTTON)</span>
        <span class="s1">progress_bar_button.click()</span>
        <span class="s1">time.sleep(random.randint(</span><span class="s3">4</span><span class="s0">, </span><span class="s3">6</span><span class="s1">))</span>
        <span class="s1">progress_bar_button.click()</span>
        <span class="s1">value_after = self.element_is_present(self.locators.PROGRESS_BAR_VALUE).text</span>
        <span class="s0">return </span><span class="s1">value_before</span><span class="s0">, </span><span class="s1">value_after</span>

<span class="s0">class </span><span class="s1">TabsPage(BasePage):</span>
    <span class="s1">locators = TabsPageLocators()</span>

    <span class="s0">def </span><span class="s1">check_tabs(self</span><span class="s0">, </span><span class="s1">name_tab):</span>
        <span class="s1">tabs = {</span><span class="s2">'what'</span><span class="s1">:</span>
                    <span class="s1">{</span><span class="s2">'title'</span><span class="s1">: self.locators.TABS_WHAT</span><span class="s0">,</span>
                     <span class="s2">'content'</span><span class="s1">: self.locators.TABS_WHAT_CONTENT}</span><span class="s0">,</span>
                <span class="s2">'origin'</span><span class="s1">:</span>
                    <span class="s1">{</span><span class="s2">'title'</span><span class="s1">: self.locators.TABS_ORIGIN</span><span class="s0">,</span>
                     <span class="s2">'content'</span><span class="s1">: self.locators.TABS_ORIGIN_CONTENT}</span><span class="s0">,</span>
                <span class="s2">'use'</span><span class="s1">:</span>
                    <span class="s1">{</span><span class="s2">'title'</span><span class="s1">: self.locators.TABS_USE</span><span class="s0">,</span>
                     <span class="s2">'content'</span><span class="s1">: self.locators.TABS_USE_CONTENT}</span><span class="s0">,</span>
                <span class="s2">'more'</span><span class="s1">:</span>
                    <span class="s1">{</span><span class="s2">'title'</span><span class="s1">: self.locators.TABS_MORE</span><span class="s0">,</span>
                     <span class="s2">'content'</span><span class="s1">: self.locators.TABS_MORE_CONTENT}</span><span class="s0">,</span>
                <span class="s1">}</span>

        <span class="s1">button = self.element_is_visible(tabs[name_tab][</span><span class="s2">'title'</span><span class="s1">])</span>
        <span class="s1">button.click()</span>
        <span class="s1">what_content = self.element_is_visible(tabs[name_tab][</span><span class="s2">'content'</span><span class="s1">]).text</span>
        <span class="s0">return </span><span class="s1">button.text</span><span class="s0">, </span><span class="s1">len(what_content)</span>


<span class="s0">class </span><span class="s1">ToolTipsPage(BasePage):</span>
    <span class="s1">locators = ToolTipsPageLocators()</span>

    <span class="s0">def </span><span class="s1">get_text_from_tool_tips(self</span><span class="s0">, </span><span class="s1">hover_elem</span><span class="s0">, </span><span class="s1">wait_elem):</span>
        <span class="s1">element = self.element_is_present(hover_elem)</span>
        <span class="s1">self.action_move_to_element(element)</span>
        <span class="s1">self.element_is_visible(wait_elem)</span>
        <span class="s1">tool_tip_text = self.element_is_visible(self.locators.TOOL_TIPS_INNERS)</span>
        <span class="s1">text = tool_tip_text.text</span>
        <span class="s0">return </span><span class="s1">text</span>

    <span class="s0">def </span><span class="s1">check_tool_tips(self):</span>
        <span class="s1">tool_tip_text_button = self.get_text_from_tool_tips(self.locators.BUTTON</span><span class="s0">, </span><span class="s1">self.locators.TOOL_TIP_BUTTON)</span>
        <span class="s1">tool_tip_text_field = self.get_text_from_tool_tips(self.locators.FIELD</span><span class="s0">, </span><span class="s1">self.locators.TOOL_TIP_FIELD)</span>
        <span class="s1">tool_tip_text_contrary = self.get_text_from_tool_tips(self.locators.CONTRARY_LINK</span><span class="s0">,</span>
                                                              <span class="s1">self.locators.TOOL_TIP_CONTRARY)</span>
        <span class="s1">tool_tip_text_section = self.get_text_from_tool_tips(self.locators.SECTION_LINK</span><span class="s0">, </span><span class="s1">self.locators.TOOL_TIP_SECTION)</span>
        <span class="s0">return </span><span class="s1">tool_tip_text_button</span><span class="s0">, </span><span class="s1">tool_tip_text_field</span><span class="s0">, </span><span class="s1">tool_tip_text_contrary</span><span class="s0">, </span><span class="s1">tool_tip_text_section</span>

<span class="s0">class </span><span class="s1">MenuPage(BasePage):</span>
    <span class="s1">locators = MenuPageLocators()</span>

    <span class="s0">def </span><span class="s1">check_menu(self):</span>
        <span class="s1">menu_item_list = self.elements_are_present(self.locators.MENU_ITEM_LIST)</span>
        <span class="s1">data = []</span>
        <span class="s0">for </span><span class="s1">item </span><span class="s0">in </span><span class="s1">menu_item_list:</span>
            <span class="s1">self.action_move_to_element(item)</span>
            <span class="s1">data.append(item.text)</span>
        <span class="s0">return </span><span class="s1">data</span></pre>
</body>
</html>